<!DOCTYPE html>
<html lang="zh-cn" xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-cn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="../static/tc.css">
  <title>å“”å’šå“”å’š</title>
</head>
 
<body>
  <div id="dd">
    <div>
      <img id="hd" class="ani" src="https://s1.hdslb.com/bfs/static/passport/static/img/loadTV.99606e2.gif" />
    </div>
    <div><img id="qrcode" height="170em" src="./ok.svg" /></div>
 <div class="t t1">æ‰«æäºŒç»´ç ç™»å½•</div>
        <div class="t t2"> <a class="tl" id="jumpapp" href="#">ç‚¹å‡»è¿™é‡Œ</a></div>
        <div class="t t2">è·³è½¬äº¬ä¸œAPPç™»å½•</div>
    </div>
  <div><img class="bg" src="https://s1.hdslb.com/bfs/static/passport/static/img/2233login.af9c53d.png" /></div>
  <div class="layer" id="layer"></div>
  <div id="globalAd">
    <div id='hero-img' style="background-color: #667eff;background: linear-gradient(to top, #667eff 0.0%, #667eff 0.0%);"></div>
    <div id='profile-img'><img src="../static/logo.png" /></div>
    <div id='content'>
      <p style="font-size: 20px;font-weight: bold;color:red;">æ‰«ç å…¬å‘Š</p>
      <p style="font-size: 15px;font-weight: bold;color:Orange;">æ‰«ç åè¿”å›æµè§ˆå™¨æ˜¾ç¤ºâˆšå³ä¸ºç™»å½•æˆåŠŸã€‚<br />
      é¦–æ¬¡ç™»é™†è¯·å¼€å¯ä»¥ä¸‹å°æ¸¸æˆ<br />
      å¹¶åˆ›å»ºè§’è‰²å®Œæˆæ–°æ‰‹ä»»åŠ¡<br /></p>
      <p style="font-size: 14px;font-weight: bold;text-align:justify;text-justify:inter-ideograph;color: blue; opacity: 0.5;">1ã€äº¬ä¸œğŸ‘‰æˆ‘çš„ğŸ‘‰æ›´å¤šğŸ‘‰(ä¸œä¸œå†œåœºã€ä¸œä¸œèŒå® ã€å® æ±ªæ±ªã€ä¸œä¸œå°çªã€æ‘‡é’±æ ‘)ã€‚<br />
      2ã€ä¸‹è½½ã€äº¬å–œAppã€‘ğŸ‘‰æˆ‘çš„ğŸ‘‰(äº¬å–œå†œåœºã€äº¬å–œå·¥å‚ã€äº¬å–œç‰§åœº)ã€‚<br />
      3ã€ä¸‹è½½ã€äº¬ä¸œé‡‘èã€‘ğŸ‘‰æˆ‘çš„ğŸ‘‰(å¤©å¤©æé¹…ã€å…»çŒªçŒª)ã€‚<br />
      4ã€æ¯å¤©å¯é¢†å–100+äº¬è±†å’Œè‹¥å¹²ç°é‡‘çº¢åŒ…ã€ä¼˜æƒ åˆ¸ç­‰<br /></p><br />
      <div align="left" style="float:left">
        <a href="">
         <button class="anniu">åŠ ç¾¤äº†è§£æ›´å¤š</button></a>
      </div>
      <div align="right">
        <button class="anniu" onclick="closeGlobalAd()">æœ•å·²é˜…</button>
      </div>
    </div>
  </div>
  </body>
  <script>
  var timer;
    var qrcode = document.getElementById("qrcode")
    var loginUrl = ""
    var success = "https://ghproxy.com/https://raw.githubusercontent.com/SamDudu/xdd/main/static/ok.svg";
    var jumpapp = document.getElementById('jumpapp')
    var hd = document.getElementById("hd")

    function showQrcode() {
        var xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                data = JSON.parse(xmlhttp.responseText)
                if (data.url && data.url.indexOf("http") != -1) {
                    qrcode.src = "data:image/png;base64," + data.img
                    loginUrl = data.url
                } else {
                    showQrcode()
                }
            }
        }
        xmlhttp.open("GET", "/api/login/qrcode", true);
        xmlhttp.send();
    }
    showQrcode()

    function login() {
        var xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var results = xmlhttp.responseText
                console.log(results)
                switch (results) {
                    case "æˆæƒç™»å½•æœªç¡®è®¤":
                        break;
                    case "ç™»å½•":
                        hd.style.visibility = "hidden";
                        qrcode.src = success
                        clearInterval(timer)
                        setTimeout(() => {
                            window.location.href = "/admin"
                        }, 1000);
                        break;
                    case "æˆåŠŸ":
                        hd.style.visibility = "hidden";
                        qrcode.src = success
                        clearInterval(timer)
                        break;
                    default:
                        showQrcode()
                        break;
                }
            }
        }
        xmlhttp.open("GET", "/api/login/query", true);
        xmlhttp.send();
    }

    function polling() {
        timer = setInterval(() => {
            login()
        }, 1500);
    }
    polling()

    jumpapp.addEventListener('click', function() {
        if (loginUrl) {
            window.location.href = `openapp.jdmobile://virtual/ad?params=${encodeURI(
                JSON.stringify({
                    category: 'jump',
                    des: 'ThirdPartyLogin',
                    action: 'to',
                    onekeylogin: 'return',
                    url: loginUrl,
                    authlogin_returnurl: 'weixin://',
                    browserlogin_fromurl: window.location.host,
                })
            )}`;
        } else {
            alert('è¿˜æ²¡åŠ è½½å¥½ï¼Œè¯·ç¨åé‡è¯•');
        }
    })

            function closeGlobalAd() {
               var layer = document.getElementById('layer');
               var globalAd = document.getElementById('globalAd');
               globalAd.style.display = "none";
               layer.style.display = "none";
            }
  </script>

</html>

